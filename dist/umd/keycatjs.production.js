!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).keycatjs={})}(this,function(t){"use strict";var i=function(){var r=this;this.resolve=null,this.reject=null,this.promise=new Promise(function(t,n){r.resolve=t,r.reject=n})},c=function(){return(c=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},s=function(t){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},u={eos:["telos","telos-testnet"]};function n(){}var l={eos:(n.prototype.isAcceptable=function(t){var n=t.name,r=t.nodes;t.urlOrigin;return!!u.eos.find(function(t){return n===t})&&(r||function(t){var n=t.name,r=t.property,e=t.blockchain;throw new Error("Property '"+r+"' in 'blockchain' is required. This error occurred because '"+n+"' should follow initialization rules of '"+e+"' configuration.")}({name:n,property:"nodes",blockchain:"eos"}),!0)},n)},r=function(t,n){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var e,o,i=r.call(t),a=[];try{for(;(void 0===n||0<n--)&&!(e=i.next()).done;)a.push(e.value)}catch(t){o={error:t}}finally{try{e&&!e.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=function(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(r(arguments[n]));return t};function e(t,n,r){var e=new URL(t+n),o=new URLSearchParams;return o.set("blockchain",JSON.stringify(r.blockchain)),o.set("client",location.origin),r.account&&o.set("account",r.account),r.args&&o.set("payload",r.args),e.search=o.toString(),e.href}var a,f=(a=function(t,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)},function(t,n){function r(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),h=function(t){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},p=(y.prototype.validateBlockchain=function(t){var n,r,e=t.name,o=t.plugin,i=Object.keys(l);try{for(var a=h(i),c=a.next();!c.done;c=a.next()){var s=c.value;if((new l[s]).isAcceptable(t))return}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if(!e||!o)throw new Error("Unknown configuration for 'blockchain' property.");console.warn("You are using custom name. We hope you understand what you are doing. We recommend using a preset name.")},y.prototype.spawnWindow=function(t,n){var r=this;if(void 0===n&&(n=!1),n&&!this._account)throw new Error('You must chain "account" method first. e.g) keycat.account(accountName).transact(...) ');var e=new i;this.win=function(t,n){if("page"===n)return window.open(t,"_blank");var r=["width=480","height=720","top="+(window.top.outerHeight/2+window.top.screenY-360),"left="+(window.top.outerWidth/2+window.top.screenX-240)].join(",");return window.open(t,"Keycat",r)}(t,this.config.ux);var o=setInterval(function(){r.win&&!r.win.closed||(clearInterval(o),e.reject("closed"))},500);return window.onmessage=function(t){var n=t.data;n.____keycat&&r.sendResponse(n,e)},e.promise},y.prototype.sendResponse=function(t,n){var r,e,o=t.type,i=t.payload;"close"===o?n.reject("closed"):(r=i.data,(e=i.error)&&n.reject(e),r&&n.resolve(r)),this.win&&this.win.close(),this.win=null},y.prototype.makeUrlData=function(t){var n=function(t){for(var n=new Uint16Array(t.length),r=0;r<n.length;r++)n[r]=t.charCodeAt(r);return String.fromCharCode.apply(String,o(new Uint8Array(n.buffer)))}(JSON.stringify(t)),r=function(t){for(var n=new Uint8Array(t.length),r=0;r<n.length;r++)n[r]=t.charCodeAt(r);return String.fromCharCode.apply(String,o(new Uint16Array(n.buffer)))}(btoa(n)),e=encodeURIComponent(r);return{blockchain:function(n){var r,t,e=Object.keys(u);try{for(var o=s(e),i=o.next();!i.done;i=o.next()){var a=i.value;if(u[a].find(function(t){return t===n.name}))return c(c({},n),{plugin:a})}}catch(t){r={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(r)throw r.error}}if(!n.plugin)throw new Error("Cannot find 'plugin' property for your custom 'blockchain' configuration.");return n}(this.config.blockchain),account:this._account,args:e}},Object.defineProperty(y.prototype,"keycatOrigin",{get:function(){var t,n=this.config.blockchain,r=n.origin,e=n.name;if("telos"===e)t="https://sign.telos.net";else{if("telos-testnet"!==e)throw new Error("Unknown network "+e);t="https://sign-dev.telos.net"}return new URL(r||t).origin},enumerable:!1,configurable:!0}),y.prototype.account=function(t){return this._account=t,this},y.prototype.signin=function(){var t=e(this.keycatOrigin,"/signin",this.makeUrlData());return this.spawnWindow(t)},y.prototype.transact=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e(this.keycatOrigin,"/transact",this.makeUrlData(t));return this.spawnWindow(r,!0)},y.prototype.signArbitraryData=function(t){var n=e(this.keycatOrigin,"/sign-arbitrary-data",this.makeUrlData([t]));return this.spawnWindow(n,!0)},y.prototype.signTransaction=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e(this.keycatOrigin,"/sign-transaction",this.makeUrlData(t));return this.spawnWindow(r,!0)},y);function y(t){this.config=t,this.sign=this.signTransaction,this.validateBlockchain(t.blockchain),this._account=t.account}var d,w=(f(g,d=p),g);function g(t,n){return d.call(this,{blockchain:{name:"telos",origin:n,nodes:t}})||this}var v,b=(f(m,v=p),m);function m(t,n){return v.call(this,{blockchain:{name:"telos-testnet",origin:n,nodes:t}})||this}p.Telos=w,p.TelosTestnet=b,t.Keycat=p,Object.defineProperty(t,"__esModule",{value:!0})});